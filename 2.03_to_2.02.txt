// Written by Thomas Thelen
// Contact: https://github.com/ThomasThelen


//Start at PUSHAD
run
//Clear any existing breakpoints
bc
bphwc

//Find the OEP
find CIP, E91B33FFFF// Signature of OEP jump
cmp $result, 0	// Check for success
je error	// Error otherwise
bp $result	// Set a breakpoint on the jump
run	// Continue execution to the jump
st	// Take the jump to the second jump
st	// Take jump to OEP
ret	// Return to user


error:
msg "Could not find the OEP."
ret